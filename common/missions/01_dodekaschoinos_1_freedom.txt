dodekaschoinos_1_freedom = {
    header = "mission_image_general"
    icon = "general_1"

    repeatable = no

    chance = {}

    potential = {
    	tag = DOD
        always = no  #nope
    	NOT = { has_variable = dod_missions_cooldown }
    }

    abort = {}

    on_potential = {}

    on_start = {
        start_mission_ai_effect = yes
    }

    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = dod_missions_cooldown
            days = 7300
        }
    }
    on_completion = {
    	complete_mission_effect = yes
    }

    dodekaschoinos_1_freedom_task_1 = {	#The Twelve Cities
        icon = "task_political"
        allow = {}

        on_completion = {}
    }

    dodekaschoinos_1_freedom_task_2 = {	#A Diplomatic Approach (diplo)
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_1 }
        prevented_by = { dodekaschoinos_1_freedom_task_3 }
        bypass = { has_completed_mission_task = dodekaschoinos_1_freedom_task_3 }

        allow = {
        	political_influence >= 15
        }

        on_completion = {
        	add_political_influence = -15
			reverse_add_opinion = {
				modifier = diplomatic_stance_pos_opmod
				target = c:KSH
			}
        }
    }

    dodekaschoinos_1_freedom_task_3 = {	#Fight for Freedom (mil)
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_1 }
        prevented_by = { dodekaschoinos_1_freedom_task_2 }
        bypass = { has_completed_mission_task = dodekaschoinos_1_freedom_task_2 }

        allow = {
        	political_influence >= 15
        }

        on_completion = {
        	add_political_influence = -15
			reverse_add_opinion = {
				modifier = agressive_stance_neg_opmod
				target = c:KSH
			}
        }
    }

    dodekaschoinos_1_freedom_task_4 = {	#A Reliable Alliance (mil)
        icon = "task_political"
		requires = { dodekaschoinos_1_freedom_task_3 }
        prevented_by = { dodekaschoinos_1_freedom_task_2 }
        bypass = { has_completed_mission_task = dodekaschoinos_1_freedom_task_2 }
        allow = {
        	#Any country that is not the overlord has at least 50 opinion
        	any_country = {
        		NOR = { 
        			this = c:KSH
        			this = root
        		}
        		opinion = {
        			target = root
        			value >= 50
        		}
        	}
        }

        on_completion = {
        	#Send an envoy to request aid in the coming war.
        	custom_tooltip = dodekaschoinos_1_freedom_task_4_tooltip
        }
    }

    dodekaschoinos_1_freedom_task_5 = {	#Improving Kushite relations (diplo)
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_2 }
        prevented_by = { dodekaschoinos_1_freedom_task_3 }
        bypass = { has_completed_mission_task = dodekaschoinos_1_freedom_task_3 }

        allow = {
        	any_country = {
        		this = c:KSH
        		opinion = {
        			target = root
        			value >= 100
        		}
        	}
        }

        on_completion = {
			current_ruler = {
				add_popularity = popularity_large
			}
			add_country_modifier = {
				name = gm_subject_opinion_cmod
				duration = 1825	# 5 years
			}
        }
    }

    dodekaschoinos_1_freedom_task_6 = {	#Drafting a proposal
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_5 }
        prevented_by = { dodekaschoinos_1_freedom_task_3 }
        bypass = { has_completed_mission_task = dodekaschoinos_1_freedom_task_3 }

        allow = {}

        on_completion = {}
    }

    dodekaschoinos_1_freedom_task_7 = {	#Preparing for War (mil)
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_4 }
        prevented_by = { dodekaschoinos_1_freedom_task_2 }
        bypass = { has_completed_mission_task = dodekaschoinos_1_freedom_task_2 }

        allow = {
	       	custom_tooltip = {
	       		text = thebes_missions_01_restoration_task_4_tooltip
		       	any_character = {
		       		is_mercenary = yes
		        }
	        }
        }

        on_completion = {}
    }
    dodekaschoinos_1_freedom_task_8 = {	#Sending an Ultimatum (mil)
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_7 }
        prevented_by = { dodekaschoinos_1_freedom_task_2 }
        bypass = { has_completed_mission_task = dodekaschoinos_1_freedom_task_2 }

        allow = {
       		political_influence >= 10
        }

        on_completion = {
        	add_political_influence = -10
        }
    }
    dodekaschoinos_1_freedom_task_9 = {	#Freedom at last
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_8 dodekaschoinos_1_freedom_task_10 }

        allow = {
        	is_subject = no	
        }

        on_completion = {
        	if = {
        		limit = { has_completed_mission_task = dodekaschoinos_1_freedom_task_2 } #(diplo)
				add_country_modifier = {
					name = gm_subject_diplo_reward_cmod
					duration = 5475	# 15 years
				}
        	}
        	else = {
        		limit = { has_completed_mission_task = dodekaschoinos_1_freedom_task_3 } #(mil)
				add_country_modifier = {
					name = gm_subject_military_reward_cmod
					duration = 5475	# 15 years
				}
        	}
        }
    }
    dodekaschoinos_1_freedom_task_10 = {	#Sending a proposal (diplo)
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_6 }
        prevented_by = { dodekaschoinos_1_freedom_task_3 }
        bypass = { has_completed_mission_task = dodekaschoinos_1_freedom_task_3 }

        allow = {
        	political_influence >= 10	
        }

        on_completion = {
        	add_political_influence = -10
#        	custom_tooltip = dodekaschoinos_1_freedom_task_10_tooltip
        }
    }
    dodekaschoinos_1_freedom_task_11 = {	#A New City
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_13 }

        allow = {
        	any_owned_province = {
        		count >=  3
        		is_in_area = aswan_area
        		has_city_status = yes
        	}
        }

        on_completion = {
        	random_owned_province = {
        		limit = {
        			is_in_area = aswan_area
        			has_city_status = yes
        			NOR = {
        				this = p:593
        				this = p:591
        			}
        		}
        		add_province_modifier = {
        			name = aswan_aspirations
        			duration = 3650
        		}
        	}
        }
    }
    dodekaschoinos_1_freedom_task_12 = {	#Supplying the Cities
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_13 }

        highlight = {
        	scope:province = {
        		OR = {
        			province_id = 595
        			province_id = 597
        			province_id = 599
        			province_id = 598
        		}
        	}
        }

        allow = {
        	calc_true_if = {
        		amount >= 2
        		p:595 = {
        			num_of_basic_settlement_infratructure_building = 1
        		}
        		p:597 = {
        			num_of_basic_settlement_infratructure_building = 1
        		}
        		p:599 = {
        			num_of_basic_settlement_infratructure_building = 1
        		}
        		p:598 = {
        			num_of_basic_settlement_infratructure_building = 1
        		}
        	}
        }

        on_completion = {
        	every_owned_province = {
        		limit = {
        			is_in_area = aswan_area
        			num_of_basic_settlement_infratructure_building = 1
        		}
        		add_province_modifier = {
        			name = increased_food_production
        			duration = -1
        		}
        	}
        }
    }
    dodekaschoinos_1_freedom_task_13 = {	#The City of Isis
        icon = "task_political"
        highlight = {
        	scope:province = {
        		this = p:591
        	}
        }
        allow = {
        	p:591 = {
        		num_of_used_building_slots >= 3
        		trigger_if = {
        			limit = { has_construction = yes }
        			custom_tooltip = {
        				text = province_has_no_constuction_tooltip
        				has_construction  = no
        			}
        		}        		
        	}	
        }

        on_completion = {
        	p:591 = {
	        	add_permanent_province_modifier = {
	        		name = city_of_isis
	        		mode = add
	        	}
        	}
            create_country_treasure = {
                key = pillar_of_isis
                icon = treasure_sarcophagus
                modifier = {
                    local_happiness_for_same_religion_modifier = 0.1
                    local_population_growth = 0.02
                }
            }
        }
    }
    dodekaschoinos_1_freedom_task_14 = {	#Great Temple of Isis
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_11 dodekaschoinos_1_freedom_task_12 }
        highlight = {
        	scope:province = {
        		this = p:591
        	}
        }
        allow = {
        	p:591 = {
        		num_of_temple_building = 1
        		trigger_if = {
        			limit = { has_construction = yes }
        			custom_tooltip = {
        				text = province_has_no_constuction_tooltip
        				has_construction  = no
        			}
        		}
        	}
        }

        on_completion = {
        	p:591 = {
	        	add_permanent_province_modifier = {
	        		name = city_of_isis
	        		mode = add
	        	}
        	}
        }
    }
#Egyptian Branch
#----------------------------------------------------------------------------------------
    dodekaschoinos_1_freedom_task_15 = {	#The Egyptian People (egypt)
        icon = "task_political"

        allow = {
        	political_influence >= 10	
        }

        on_completion = {
        	random_owned_province = {
        		while = {
        			limit = {
        				total_population < population_cap
        			}
        			count = 2
        			define_pop = {
        				type = citizen
        				culture = root.culture
        				religion = root.religion
        			}
        		}
        	}
        	random_owned_province = {
        		while = {
        			limit = {
        				total_population < population_cap
        			}
        			count = 3
        			define_pop = {
        				type = freemen
        				culture = root.culture
        				religion = root.religion
        			}
        		}
        	}
        }
    }
    dodekaschoinos_1_freedom_task_16 = {	#Nobles of Egypt
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_15 }
        prevented_by = { dodekaschoinos_1_freedom_task_17 }
        bypass = { has_completed_mission_task = dodekaschoinos_1_freedom_task_17 }
        potential = {
        	has_variable = egyptian_focus
        }
        allow = {
           	any_country_culture = {
                is_culture = egyptian
                has_pop_type_right = nobles
           	}
        }

        on_completion = {
        	capital_scope = {
        		while = {
        			limit = {
        				total_population < population_cap
        			}
        			count = 3
        			define_pop = {
        				type = nobles 
        				culture = root.culture
        				religion = root.religion
        			}
        		}        		
        	}
        	add_innovation = 1
        }
    }
    dodekaschoinos_1_freedom_task_17 = {	#Egyptian Citizens
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_15 }
        prevented_by = { dodekaschoinos_1_freedom_task_16 }
        bypass = { has_completed_mission_task = dodekaschoinos_1_freedom_task_16 }
        potential = {
        	has_variable = egyptian_focus
        }
        allow = {
           	any_country_culture = {
                is_culture = egyptian
                has_pop_type_right = citizen
           	}
        }

        on_completion = {
        	add_treasury = 250
        }
    }
    dodekaschoinos_1_freedom_task_18 = {	#The Priestly Class
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_16 dodekaschoinos_1_freedom_task_17 }
        potential = {
        	has_variable = egyptian_focus
        }
        allow = {

        }

        on_completion = {

        }
    }
    dodekaschoinos_1_freedom_task_19 = {	#The Priestly Class
        icon = "task_political"
        requires = { dodekaschoinos_1_freedom_task_18 }
        potential = {
        	has_variable = egyptian_focus
        }
        allow = {

        }

        on_completion = {

        }
    }
}